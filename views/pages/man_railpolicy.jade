extends ../layout

block content
    .page-header(class="position-relative")
        .header-title(style="width:180px;")
            h1 ç­–ç•¥
                small
                    i(class="fa fa-angle-right")
                    a(href="javascript:policylist()") #{ title }
                    i(class="fa fa-angle-right addpolicy" style="display:none;") æ·»åŠ 
                    i(class="fa fa-angle-right modpolicy" style="display:none;") ç¼–è¾‘
                    i(class="fa fa-angle-right viewpolicy" style="display:none;") è¯¦æƒ…
                    i(class="fa fa-angle-right issuedpolicy" style="display:none;") ä¸‹å‘
    .page-body
        .row
            .policylist(class="col-xs-12 col-md-12")
                .widget
                    .widget-btn
                        a(class="btn btn-primary" href="javascript:add()") 
                            i(class="fa fa-plus") æ·»åŠ 
                        a(class="btn btn-primary" href="javascript:auth()") 
                            i(class="fa fa-magic") ä¸‹å‘
                        a(class="hrefactive" href="javascript:refresh()" style="cursor:pointer;opacity:1;")
                            i(class="fa fa-refresh" style="font-size:20px;")
                            p(style="font-size:10px;margin:0;") åˆ·æ–°
                        a(class="hrefactive" href="javascript:activate(1)")
                            i(class="fa fa-check-circle" style="font-size:20px;")
                            p(style="font-size:10px;margin:0;") å¯ç”¨
                        a(class="hrefactive" href="javascript:activate(0)")
                            i(class="fa fa-times-circle" style="font-size:20px;")
                            p(style="font-size:10px;margin:0;") ç¦ç”¨
                        a(class="hrefactive" href="javascript:deletes()")
                            i(class="fa fa-minus-square" style="font-size:20px;")
                            p(style="font-size:10px;margin:0;") åˆ é™¤
                        .input-group(class="input-group-sm")
                            input(class="form-control" type="text" style="float:right;max-width:200px;" placeholder="åç§°" onfocus="this.placeholder=''")
                            span(class="input-group-btn")
                                button(class="btn btn-default btn-primary" type="button")
                                    i(class="glyphicon glyphicon-search")
                    .policytable(class="widget-body" style="box-shadow:none;padding:0;")
                    .page1
        .row
            .policy_add(class="col-xs-12 col-md-12 setting" style="display:none;")
                .widget(style="border: 1px solid #ccc;border-radius: 3px 3px 3px 3px;")
                    .widget-header(style="height:40px;")
                        p(style="line-height: 40px;text-align: left;font-size: 16px;font-weight: bold;color: #444;") åŸºæœ¬ä¿¡æ¯
                    .widget-body(style="overflow:hidden;")
                        .row(class="col-xs-12 col-md-12" style="margin-bottom:0px;")
                            .form-group
                                div(class="col-lg-6 col-xs-6 col-sm-8 col-lg-offset-3 col-xs-offset-3 col-sm-offset-2")
                                    label(class="control-label" for = "name" style="width:110px;")
                                        i(class="icon glyphicon glyphicon-asterisk" style="color:red; font-size:12px;margin-right:10px;")
                                        label åç§°
                                    .adddiv(style="left: 140px;")
                                        input(type="text" name="policyid" style="display:none;")
                                        input(type="text" class="form-control" id = "name" name="name")
                        .row(class="col-xs-12 col-md-12" style="margin-bottom:0px;")
                            .form-group
                                div(class="col-lg-6 col-xs-6 col-sm-8 col-lg-offset-3 col-xs-offset-3 col-sm-offset-2")
                                    label(class="control-label" style="width:110px; padding-left:22px;") ç±»å‹
                                    .adddiv(style="left:140px;")
                                        select(class="form-control" name="policy_type" id="policy_type")
                                            option(class="option" value="1") åœ°ç†å›´æ 
                                            option(class="option" value="2") æ—¶é—´å›´æ                                    
                    .widget-header(style="height:40px;")
                        p(style="line-height: 40px;text-align: left;font-size: 16px;font-weight: bold;color: #444;") å›´æ é™åˆ¶
                    .widget-body(style="overflow: hidden;display:none;" class="timepolicy")
                        .row(class="col-xs-12 col-md-12" style="margin-bottom:0px;")
                            .form-group
                                div(class="col-lg-6 col-xs-6 col-sm-8 col-lg-offset-3 col-xs-offset-3 col-sm-offset-2")
                                    label(class="control-label" style="width:110px;")
                                        i(class="icon glyphicon glyphicon-asterisk" style="color:red; font-size:12px;margin-right:10px;")
                                        label é‡å¤ç±»å‹
                                    .adddiv(style="left:140px;")
                                        select(class="form-control" name="repeat_type" id="repeat_type")
                                            option(class="option" value="1") æ¯å‘¨
                                            option(class="option" value="2") æ¯æ—¥
                                            option(class="option" value="3") å·¥ä½œæ—¥
                                            option(class="option" value="4") ç‰¹å®šæ—¥æœŸ
                                .everyweek(class="col-lg-2 col-xs-2 col-sm-2")
                                    select(class="form-control" name="weekday" id="weekday")
                                        option(class="option" value="1") æ˜ŸæœŸä¸€
                                        option(class="option" value="2") æ˜ŸæœŸäºŒ
                                        option(class="option" value="3") æ˜ŸæœŸä¸‰
                                        option(class="option" value="4") æ˜ŸæœŸå››
                                        option(class="option" value="5") æ˜ŸæœŸäº”
                                        option(class="option" value="6") æ˜ŸæœŸå…­
                                        option(class="option" value="7") æ˜ŸæœŸæ—¥
                        .row(class="col-xs-12 col-md-12" style="margin-bottom:0px;")
                            .form-group
                                div(class="col-lg-6 col-xs-6 col-sm-8 col-lg-offset-3 col-xs-offset-3 col-sm-offset-2")
                                    label(class="control-label" style="width:110px;")
                                        i(class="icon glyphicon glyphicon-asterisk" style="color:red; font-size:12px;margin-right:10px;")
                                        label èµ·æ­¢æ—¥æœŸ
                                    .adddiv(style="left:140px;")
                                        div(class="col-lg-5 col-xs-5 col-sm-5" style="padding-left:0;padding-right:0;")
                                            input(id="start_date" class="start_date" type="text" name="start_date" class="form-control cursor")
                                        div(class="col-lg-2 col-xs-2 col-sm-2" style="text-align:center;")
                                            label è‡³
                                        div(class="col-lg-5 col-xs-5 col-sm-5" style="padding-left:0;padding-right:0;")
                                            input(id="stop_date" class="stop_date" type="text" name="stop_date" class="form-control cursor")
                        .row(class="col-xs-12 col-md-12" style="margin-bottom:0px;")
                            .form-group
                                div(class="col-lg-6 col-xs-6 col-sm-8 col-lg-offset-3 col-xs-offset-3 col-sm-offset-2")
                                    label(class="control-label" style="width:110px;")
                                        i(class="icon glyphicon glyphicon-asterisk" style="color:red; font-size:12px;margin-right:10px;")
                                        label èµ·æ­¢æ—¶é—´
                                    .adddiv(style="left:140px;")
                                        div(class="col-lg-5 col-xs-5 col-sm-5" style="padding-left:0;padding-right:0;")
                                            input(id="start_time" class="start_time" type="text" name="start_time" class="form-control cursor")
                                        div(class="col-lg-2 col-xs-2 col-sm-2" style="text-align:center;")
                                            label è‡³
                                        div(class="col-lg-5 col-xs-5 col-sm-5" style="padding-left:0;padding-right:0;")
                                            input(id="stop_time" class="stop_time" type="text" name="stop_time" class="form-control cursor")
                    .widget-body(style="overflow: hidden;" class="addresspolicy")
                        .row(class="col-xs-12 col-md-12" style="margin-bottom:0px;")
                            .form-group
                                div(class="col-lg-6 col-xs-10 col-sm-10 col-lg-offset-3 col-xs-offset-1 col-sm-offset-1")
                                    label(class="control-label" style="width:110px;")
                                        i(class="icon glyphicon glyphicon-asterisk" style="color:red; font-size:12px;margin-right:10px;")
                                        label åœ°ç‚¹èŒƒå›´
                                    .adddiv(style="left: 140px;") 
                                        div(class="col-lg-8 col-xs-8 col-sm-8" style="padding-left:0;padding-right:0;")
                                            label(style="width:40px;") åæ ‡
                                            label (
                                            label(class="pointer" style="font-weight:normal;")
                                            label )
                                        div(class="col-lg-4 col-xs-4 col-sm-4" style="padding-left:0;padding-right:0;")
                                            label(style="width:40px;") èŒƒå›´
                                            label(class="radius" style="font-weight:normal;")
                                            label(style="width:20px;text-align:right;") ç±³
                        .row(class="col-xs-12 col-md-12" style="margin-bottom:0px;margin-top:0px;padding-right:0px;")
                            .address(id="address" class="col-lg-7 col-xs-10 col-sm-10 col-lg-offset-3 col-xs-offset-1 col-sm-offset-1")
                            input(type="text" id = "searchaddress" name="searchaddress" placeholder="ğŸ”æœç´¢åœ°å€")
                            a(href="javascript:bridgemap()" class="addressicon")
                                i(class="icon glyphicon glyphicon-fullscreen")
                            a(href="javascript:minmap()" class="addressicon2")
                                i(class="icon glyphicon glyphicon-resize-small")
                        .row(class="col-xs-12 col-md-12" style="margin-bottom:0px;margin-top:0px;")
                            .form-group
                                div(class="col-lg-6 col-xs-6 col-sm-6 col-lg-offset-3 col-xs-offset-3 col-sm-offset-2")
                                    label(class="control-label" for = "gps" style="width:150px;padding-left:22px;") å…³é—­GPSé™ç½®
                                    .adddiv(style="left:180px;width:450px;")
                                        label(class="cursor")
                                            input(type="checkbox" onclick="checkthis(this)" id = "gps" name="gps")
                                            span(class="text") è®¾å¤‡å…³é—­GPSåŠŸèƒ½åè§†ä¸ºåœ¨å›´æ å†…
                        .row(class="col-xs-12 col-md-12" style="margin-bottom:0px;margin-top:0px;")
                            .form-group
                                div(class="col-lg-8 col-xs-8 col-sm-8 col-lg-offset-3 col-xs-offset-3 col-sm-offset-2")
                                    label(class="control-label" for = "wifi" style="width:150px;padding-left:22px;") è¿æ¥Wifié™åˆ¶
                                    .adddiv(style="left:180px;width:450px;")
                                        label(class="cursor")
                                            input(type="checkbox" onclick="checkthis(this)" id = "wifi" name="wifi")
                                            span(class="text") è®¾å¤‡è¿æ¥æŒ‡å®šWifiåè§†ä¸ºåœ¨å›´æ å†…
                                        input(type="text" name="ssid" placeholder="è¯·è¾“å…¥SSID")
                    .widget-header(style="height:40px;")
                        p(style="line-height: 40px;text-align: left;font-size: 16px;font-weight: bold;color: #444;") å›´æ å†…ç­–ç•¥
                    .widget-body(style="overflow: hidden;")
                        .row(class="col-xs-12 col-md-12" style="margin-bottom:0px;")
                            .form-group
                                div(class="col-lg-6 col-xs-6 col-sm-8 col-lg-offset-3 col-xs-offset-3 col-sm-offset-2")
                                    label(class="control-label" style="width:110px; padding-left:22px;") è®¾å¤‡ç­–ç•¥
                                    .adddiv(style="left:140px;")
                                        select(class="form-control" name="in_fence" id="in_fence")
                    .widget-header(style="height:40px;")
                        p(style="line-height: 40px;text-align: left;font-size: 16px;font-weight: bold;color: #444;") å›´æ å¤–ç­–ç•¥
                    .widget-body(style="overflow: hidden;")
                        .row(class="col-xs-12 col-md-12" style="margin-bottom:0px;")
                            .form-group
                                div(class="col-lg-6 col-xs-6 col-sm-8 col-lg-offset-3 col-xs-offset-3 col-sm-offset-2")
                                    label(class="control-label" style="width:110px; padding-left:22px;") è®¾å¤‡ç­–ç•¥
                                    .adddiv(style="left:140px;")
                                        select(class="form-control" name="out_fence" id="out_fence")
                        .row
                            .form-group
                                div(class="col-lg-6 col-xs-6 col-sm-8 col-lg-offset-3 col-xs-offset-3 col-sm-offset-2" style="height:60px;")
                                    label(class="control-label" style="width:110px; padding-left:22px;")
                                    .adddiv(style="left:140px;text-align:center;margin-top:14px;")
                                        .div(class="col-lg-6 col-xs-6 col-sm-6" style="padding-top:10px;text-align:right;")
                                            a(class="btn" href="javascript:policylist()" style="width:78px;") å–æ¶ˆ
                                        .div(class="col-lg-6 col-xs-6 col-sm-6" style="padding-top:10px; text-align:left;" class="addbtn")
                                            a(class="btn btn-primary" href="javascript:add_policy()" style="width:78px;") ä¿å­˜
                                        .div(class="col-lg-6 col-xs-6 col-sm-6" style="padding-top:10px;display:none;text-align:left;" class="modbtn")
                                            a(class="btn btn-primary" href="javascript:mod_policy()") ä¿å­˜å¹¶ä¸‹å‘
                                        //-.div(class="col-lg-6 col-xs-6 col-sm-6" style="padding-top:10px;display:none;text-align:left;" class="viewbtn")
                                            a(class="btn btn-primary" href="javascript:policylist()" style="width:78px;") ç¡®è®¤
        .row(class="issuedlist" style="display:none;")
            .widget
                div(class="col-xs-12 col-md-12")
                    .widget-btn
                        a(class="btn btn-primary issuedpl" href="javascript:authbtn()")
                            i(class="fa fa-check") ä¸‹å‘
                        .input-group(class="input-group-sm" style="padding-right:27px;")
                            input(class="form-control" type="text" name="keyvalue" placeholder="æŒ‰è´¦å·æœç´¢" onfocus="this.placeholder=''" style="float:right;max-width:200px;")
                            span(class="input-group-btn")
                                button(class="btn btn-default btn-primary" type="button" onclick="searchauthlist()")
                                    i(class="glyphicon glyphicon-search")
            .tab(class="col-lg-12 col-sm-12 col-xs-12")
                .widget-main
                    .tabbable
                        input(name="policy_id" style="display:none;")
                        input(name="policy_type" style="display:none;")
                        ul(class="nav nav-tabs tabs-flat" id="myTab11")
                            li(class="active")
                                a(data-toggle="tab" href="#departs") ç”¨æˆ·ç»„
                            li
                                a(data-toggle="tab" href="#usertag") æ ‡ç­¾åˆ—è¡¨
                        div(class="tab-content tabs-flat")
                            div(id="departs" class="tab-pane in active")
                                div(class="col-lg-4 col-sm-4 col-xs-4")
                                    #treegroup
                                div(class="col-lg-8 col-sm-8 col-xs-8")
                                    .usertable(style="box-shadow:none;padding:0;")
                                    .page2
                            div(id="usertag" class="tab-pane")
                                div(class="col-lg-4 col-sm-4 col-xs-4")
                                    ul(id="usertaglist" style="padding-left:0px;")
                                div(class="col-lg-8 col-sm-8 col-xs-8")
                                    .tagusertable(style="box-shadow:none;padding:0;")
                                    .page3
        .bootbox(class="modal fade bootbox-confirm in modal-primary" tabindex="-1" role="dialog" style="display:none;" aria-hidden="false")
            .modal-dialog(style="width:500px;")
                .modal-content
        .background
    script(async="true" src="/scripts/jquery.min.js")
    script(src="/scripts/jedate/jquery-1.7.2.js")
    script(src="/scripts/jedate/jquery.jedate.js")
    script(type="text/javascript" src="http://webapi.amap.com/maps?v=1.3&key=44ffc5b6029cb5a30b0a83e36577079d")
    script(type="text/javascript" src="http://cache.amap.com/lbs/static/addToolbar.js")
    script(type="text/javascript" src="https://webapi.amap.com/maps?v=1.3&key=44ffc5b6029cb5a30b0a83e36577079d")
    script(type="text/javascript" src="https://cache.amap.com/lbs/static/addToolbar.js")
    script(async="true" src="/scripts/man_railpolicy.js")
    script(type='text/javascript').
        $(".stop_date").jeDate({
            format: "YYYY-MM-DD"
        });
        $(".start_date").jeDate({
            format: "YYYY-MM-DD"
        });
        $(".start_time").jeDate({
            format: "hh:mm:ss"
        });
        $(".stop_time").jeDate({
            format: "hh:mm:ss"
        });
        $("select#policy_type").change(function(){
            if($(this).val() == 1){
                $(".timepolicy").css({'display':'none'});
                $(".addresspolicy").css({'display':'block'});
            } else {
                $(".addresspolicy").css({'display':'none'});
                $(".timepolicy").css({'display':'block'});
            }
        });
        $("select#repeat_type").change(function(){
            if($(this).val() == 1){
                $(".everyweek").css({'display':'block'});
            } else {
                $(".everyweek").css({'display':'none'});
            }
        });
